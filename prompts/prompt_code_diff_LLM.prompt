# prompt_code_diff_LLM.prompt

You are an expert code analyst. Perform a BIDIRECTIONAL analysis between the prompt and code.

PROMPT/REQUIREMENTS (with line numbers):
```
{prompt_numbered}
```

CODE (with line numbers):
```
{code_numbered}
```

Analyze BOTH directions:
1. Prompt -> Code: How well does the code implement the prompt requirements?
2. Code -> Prompt: How well does the prompt describe what the code does?

Respond with a JSON object containing:

1. "overallScore": integer 0-100, overall bidirectional match quality
2. "promptToCodeScore": integer 0-100, how well code implements prompt requirements
3. "codeToPromptScore": integer 0-100, how well prompt describes the code
4. "summary": 1-2 sentence summary covering both directions
5. "sections": array of PROMPT requirement sections (prompt -> code), each with:
   - "id": unique string like "req_1", "req_2"
   - "promptRange": {{"startLine": int, "endLine": int, "text": "excerpt"}}
   - "codeRanges": array of {{"startLine": int, "endLine": int, "text": "excerpt"}} (empty if missing)
   - "status": "matched", "partial", or "missing"
   - "matchConfidence": 0-100
   - "semanticLabel": descriptive label like "Error Handling", "Input Validation"
   - "notes": REQUIRED one-sentence explanation of WHY this status exists:
     * For "missing": "The prompt specifies [specific requirement], but the code does not implement [what's missing]"
     * For "partial": "The prompt requires [full requirement], but the code only implements [partial aspect]"
     * For "matched": "[Requirement] is fully implemented in the code"
6. "codeSections": array of CODE feature sections (code -> prompt), each with:
   - "id": unique string like "code_1", "code_2"
   - "promptRange": {{"startLine": int, "endLine": int, "text": "excerpt"}} (the prompt lines that document this, empty text if undocumented)
   - "codeRanges": array of {{"startLine": int, "endLine": int, "text": "excerpt"}}
   - "status": "matched" (documented in prompt), "partial", or "extra" (not in prompt)
   - "matchConfidence": 0-100
   - "semanticLabel": descriptive label like "Helper Function", "Error Handler"
   - "notes": REQUIRED one-sentence explanation of WHY this status exists:
     * For "extra": "The code implements [specific feature] which is not specified in the prompt - this may be lost during regeneration"
     * For "partial": "The code feature [feature] is only partially documented in the prompt"
     * For "matched": "[Feature] is fully documented in the prompt"
7. "lineMappings": array of line-level mappings from prompt to code:
   - "promptLine": int
   - "codeLines": array of ints (corresponding code lines, can be empty)
   - "matchType": one of "exact", "semantic", "partial", "none"
8. "stats": {{
   "totalRequirements": int (from prompt),
   "matchedRequirements": int,
   "missingRequirements": int (in prompt but not in code),
   "totalCodeFeatures": int (distinct features in code),
   "documentedFeatures": int (code features documented in prompt),
   "undocumentedFeatures": int (code features not in prompt),
   "promptToCodeCoverage": float (% of prompt implemented),
   "codeToPromptCoverage": float (% of code documented)
}}
9. "missing": array of strings describing requirements in prompt but not implemented in code
10. "extra": array of strings describing code features/behaviors not documented in prompt
11. "suggestions": array of improvement suggestions for both prompt and code

Guidelines:
- For "sections": Parse prompt into logical requirements, find code implementations
- For "codeSections": Parse code into logical features/functions, find prompt documentation
- "missing" = prompt requirements without code implementation
- "extra" = code behaviors/features without prompt documentation
- Be thorough in identifying undocumented code behavior
- IMPORTANT: Always provide the "notes" field explaining WHY the status is what it is
- Be specific in notes: mention the exact requirement/feature name and what is missing/extra/partial
