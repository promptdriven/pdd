% You are an expert software engineer using Prompt-Driven Development (PDD). Your task is to identify which dev units (prompt + code + example + test) are involved in implementing this change request.

% Context

You are working on step 6 of 12 in an agentic change workflow. Previous steps conducted research, verified clarity, and analyzed documentation changes needed.

% PDD Background

<pdd_prompting_guide>
<include>docs/prompting_guide.md</include>
</pdd_prompting_guide>

% Inputs

- GitHub Issue URL: {issue_url}
- Repository: {repo_owner}/{repo_name}
- Issue Number: {issue_number}

% Issue Content
<issue_content>
{issue_content}
</issue_content>

% Previous Step Outputs
<step1_output>
{step1_output}
</step1_output>

<step2_output>
{step2_output}
</step2_output>

<step3_output>
{step3_output}
</step3_output>

<step4_output>
{step4_output}
</step4_output>

<step5_output>
{step5_output}
</step5_output>

% Your Task

1. **Understand the change request**
   - What new functionality is being requested?
   - What existing functionality needs modification?
   - What are the inputs, outputs, and constraints?

2. **Component Discovery First (CRITICAL)**
   Before proposing new modules, thoroughly search for existing components that could fulfill the requirement:
   - Search `pdd/` for modules with similar functionality (use keyword search, grep for related functions)
   - Review `prompts/` to understand what each existing module does
   - Check if existing modules can be extended rather than duplicating functionality
   - Look at `sync_order.py` and its `build_dependency_graph()` to understand module relationships
   - Document which existing modules were considered and why they can/cannot be reused

3. **Explore the codebase**
   - Find the `prompts/` directory and list existing prompts
   - Identify prompts related to the requested functionality
   - Check `context/` for related examples
   - Look for existing tests in `tests/`

4. **Identify affected dev units**
   For each affected module, identify the complete dev unit:
   - **Prompt file**: `prompts/{{module}}_python.prompt`
   - **Code file**: `pdd/{{module}}.py` (or appropriate path)
   - **Example file**: `context/{{module}}_example.py`
   - **Test file**: `tests/test_{{module}}.py`

5. **Categorize dev units (PREFER MODIFY over CREATE)**
   - **MODIFY**: Existing dev units that need changes - ALWAYS prefer this when possible
   - **CREATE**: New dev units - ONLY when no existing module can be extended to provide the functionality
   - **DEPENDENCY**: Dev units that are dependencies (may need interface updates)

   **Anti-duplication check:** For each CREATE, you MUST justify why MODIFY is not possible. List specific existing modules that were considered and explain why they cannot be extended.

% Important: Scope of `pdd change`

**`pdd change` modifies ONLY prompt files (`.prompt`) and documentation.**

The dev unit table above shows the FULL structure for reference, but:
- Code files are GENERATED by `pdd sync`, not by `pdd change`
- Example files are GENERATED artifacts
- Test files are updated during `pdd sync`, not `pdd change`

After the PR from `pdd change` is merged, run `pdd sync <module>` to regenerate code.

% Output

After completing your analysis, use `gh issue comment` to post your findings to issue #{issue_number}:

```
gh issue comment {issue_number} --repo {repo_owner}/{repo_name} --body "..."
```

Your comment should follow this format:

```markdown
## Step 6: Dev Units Identified

**Status:** [Found N dev units | No Dev Units Found]

### Change Summary
[1-2 sentence summary of what needs to change]

### Dev Units to MODIFY
| Prompt | Code | Example | Test |
|--------|------|---------|------|
| `prompts/xxx_python.prompt` | `pdd/xxx.py` | `context/xxx_example.py` | `tests/test_xxx.py` |

### Dev Units to CREATE
| Prompt | Code | Example | Test |
|--------|------|---------|------|
| `prompts/yyy_python.prompt` | `pdd/yyy.py` | `context/yyy_example.py` | `tests/test_yyy.py` |

### Reuse Analysis (REQUIRED for each CREATE)
For each new dev unit proposed, explain:
- **Module:** `yyy`
- **Existing modules considered:** [list modules that were evaluated]
- **Why extension not possible:** [specific reason why existing modules cannot be extended]

### Dependencies (may need interface updates)
- `prompts/zzz_python.prompt` - [reason]

### Files Explored
- [List of files/directories checked]

---
*Proceeding to Step 7: Architecture Review*
```

**If no dev units can be identified (STOP workflow):**
```markdown
## Step 6: Dev Units Identified

**Status:** No Dev Units Found

### Analysis
[Explanation of why no dev units could be identified]

### Recommendation
[Suggestions for clarifying the request or alternative approaches]

---
*Investigation paused - unable to identify affected modules.*
```

% Important

- Use the PDD prompting guide to understand dev unit structure
- Be thorough in exploring the codebase
- Consider both direct changes and ripple effects on dependencies
- If no dev units can be identified, STOP the workflow
- Always post your findings as a GitHub comment before completing
