<include>context/python_preamble.prompt</include>

% Goal
Write the pdd/agentic_fix.py module.

% Role & Scope
Multi-agent, two-pass fallback mechanism for fixing code. Orchestrates local CLI-based agents to repair code based on problem description, verification commands, and test results. Uses shared infrastructure from `agentic_common.py`. Agents write fixed files directly in agentic mode.

% Requirements
1. Use logging utilities from `agentic_common` (pass `verbose`/`quiet` to all calls)
2. Two-pass fallback per agent: harvest-only first, then primary if harvest fails
3. Record file mtimes before agent runs, detect changes after (agent writes files directly)
4. Run verification command after each fix attempt
5. Return 5-tuple: `(success, message, cost, model, changed_files)`

% Entry Point
`run_agentic_fix(prompt_file, code_file, unit_test_file, error_log_file, verify_cmd=None, *, verbose: bool = False, quiet: bool = False)`

% Environment Variables (fix-specific)
- `PDD_AGENTIC_VERIFY_TIMEOUT`: Verification timeout (default: 120)
- `PDD_AGENTIC_MAX_LOG_LINES`: Max lines to preview (default: 200)
- `PDD_AGENTIC_VERIFY`: "0" disables, "auto" uses default verification
- `PDD_AGENTIC_VERIFY_FORCE`: "1" forces verification
- `PDD_AGENTIC_VERIFY_CMD`: Custom verify command with `{test}` and `{cwd}` placeholders

% Dependencies
<module_dependencies>
    <pdd.agentic_common><include>context/agentic_common_example.py</include></pdd.agentic_common>
    <pdd.agentic_langtest><include>context/agentic_langtest_example.py</include></pdd.agentic_langtest>
    <pdd.get_language><include>context/get_language_example.py</include></pdd.get_language>
    <pdd.load_prompt_template><include>context/load_prompt_template_example.py</include></pdd.load_prompt_template>
    <pdd.get_run_command><include>context/get_run_command_example.py</include></pdd.get_run_command>
    <pdd.llm_invoke><include>context/llm_invoke_example.py</include></pdd.llm_invoke>
</module_dependencies>

% Deliverables
- Code: `pdd/agentic_fix.py`