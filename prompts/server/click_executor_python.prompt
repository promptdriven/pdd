<include>context/python_preamble.prompt</include>

% Goal
Write the pdd/server/click_executor.py module.

% Role & Scope
Click command executor providing programmatic execution of PDD CLI commands with output capture, streaming support, and lazy command loading. A lighter-weight alternative to executor.py with caching and capture mode toggle.

% Requirements
1. **CapturedOutput dataclass**:
   - stdout: str, stderr: str, exit_code: int
   - exception: Optional[Exception]
   - cost: float (default 0.0, for compatibility)

2. **StreamingWriter class**:
   - Wraps StringIO buffer with callback for real-time streaming
   - write(text) -> int, flush(), isatty() -> False

3. **OutputCapture context manager**:
   - Captures stdout/stderr during command execution
   - Optional callback for real-time streaming
   - Uses StreamingWriter when callback provided, direct StringIO otherwise

4. **create_isolated_context(command, obj, color) -> click.Context**:
   - Creates Click context with hardcoded PDD defaults (strength=0.5, temperature=0.1, time=0.25)
   - Mocks get_parameter_source to return DEFAULT

5. **ClickCommandExecutor class**:
   - __init__(base_context_obj, output_callback)
   - execute(command, args, options, capture_output) -> CapturedOutput
   - `capture_output=True`: redirects to StringIO for capture
   - `capture_output=False`: outputs directly to terminal
   - Handles click.Abort, click.ClickException, general Exception

6. **get_pdd_command(command_name) -> Optional[click.Command]**:
   - Uses module-level `_command_cache` dict for lazy caching
   - Individual lazy imports to avoid circular dependencies
   - Supports: sync, update, generate, test, fix, example, bug, crash
   - Returns None and logs warning for unknown/failed imports

% Dependencies
Reference pdd.commands modules:
- maintenance: sync
- modify: update
- generate: generate, test, example
- fix: fix
- analysis: bug, crash

% Deliverables
- Code: `pdd/server/click_executor.py`
- Export: CapturedOutput, StreamingWriter, OutputCapture, create_isolated_context, ClickCommandExecutor, get_pdd_command
