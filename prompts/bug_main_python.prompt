% You are an expert Python engineer. Write a CLI wrapper function `bug_main` that generates unit tests either from a GitHub issue (agentic mode) or from manual file arguments (legacy mode).

<include>./context/python_preamble.prompt</include>
<include>./context/ctx_obj_params.prompt</include>

% Inputs/Outputs
    Inputs:
        - `ctx` (`click.Context`): Click context object (see ctx_obj_params.prompt)
        - `issue_url` (Optional[str]): GitHub issue URL for agentic mode (e.g., https://github.com/owner/repo/issues/123)
        - `manual` (bool): If True, use legacy 5-argument mode
        - `prompt_file`, `code_file`, `program_file` (Optional[str]): Paths to source files (required if manual=True)
        - `current_output`, `desired_output` (Optional[str]): Paths to output files (required if manual=True)
        - `output` (Optional[str]): Output path for generated test
        - `language` (Optional[str]): Language for test generation (default "Python")
    Output:
        - Tuple[str, float, str]: (generated_test_code_or_message, total_cost, model_name)

% Requirements
    1. **Mode detection**: If `issue_url` is provided and `manual` is False, use agentic mode. Otherwise use manual mode.
    2. **Agentic mode** (issue_url provided):
        - Validate issue_url is a valid GitHub issue URL (https://github.com/{owner}/{repo}/issues/{number})
        - Call `run_agentic_bug(issue_url, verbose=verbose, quiet=quiet)` from `pdd.agentic_bug`
        - Returns 5-tuple: (success, message, cost, model, changed_files)
        - Return (message, cost, model) to caller
    3. **Manual mode** (--manual flag or no issue_url):
        - Require all 5 file arguments (prompt_file, code_file, program_file, current_output, desired_output)
        - Call `construct_paths(command='bug', context_override=ctx.obj.get('context'))` to resolve paths
        - Call `bug_to_unit_test(current_output_str, desired_output_str, prompt_str, code_str, program_str, strength, temperature, time, language)`
        - Save to output path; print model/cost when not quiet
    4. Retrieve ctx.obj options: strength, temperature, time, force, quiet, verbose
    5. On error: print message (unless quiet) and sys.exit(1)

<examples>
<construct_paths_example>
<include>context/construct_paths_example.py</include>
</construct_paths_example>

<bug_to_unit_test_example>
<include>context/bug_to_unit_test_example.py</include>
</bug_to_unit_test_example>

<agentic_bug_example>
<include>context/agentic_bug_example.py</include>
</agentic_bug_example>
</examples>
