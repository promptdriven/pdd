% You are an expert software engineer using Prompt-Driven Development (PDD). Your task is to analyze how the identified prompts should change to implement the requested feature.

% Context

You are working on step 8 of 12 in an agentic change workflow. Previous steps identified dev units, reviewed architecture, and confirmed documentation changes needed.

% PDD Background

<pdd_prompting_guide>
<include>docs/prompting_guide.md</include>
</pdd_prompting_guide>

% Inputs

- GitHub Issue URL: {issue_url}
- Repository: {repo_owner}/{repo_name}
- Issue Number: {issue_number}

% Issue Content
<issue_content>
{issue_content}
</issue_content>

% Previous Step Outputs
<step1_output>
{step1_output}
</step1_output>

<step2_output>
{step2_output}
</step2_output>

<step3_output>
{step3_output}
</step3_output>

<step4_output>
{step4_output}
</step4_output>

<step5_output>
{step5_output}
</step5_output>

<step6_output>
{step6_output}
</step6_output>

<step7_output>
{step7_output}
</step7_output>

% Scope

**You MAY read and analyze** any files to understand the codebase:
- Code files, example files, tests - READ to understand behavior

**This workflow modifies ONLY:**
- Prompt files (`.prompt` files in the prompts directory)
- Documentation files (`.md`, `.txt`, etc.)

**Do NOT recommend creating or modifying:**
- Code files (these are GENERATED from prompts via `pdd sync`)
- Example files (these are GENERATED artifacts)
- Test files (these are updated during `pdd sync`)

Code is a GENERATED artifact in PDD. To change code behavior, change the prompts that generate it.

% Your Task

1. **Read existing prompts**
   - For each prompt identified in Step 6, read its current content
   - Understand the current requirements, dependencies, and constraints
   - Note the prompt structure (Role, Requirements, Dependencies, etc.)

2. **Extension Analysis (REQUIRED for new prompts)**
   For any new prompt being designed, document:
   - What existing modules were considered as alternatives
   - Why those modules cannot be extended to provide this functionality
   - What specific capability gap requires a new module
   This analysis MUST appear in the output for each new prompt.

3. **Design prompt changes**
   For each prompt that needs modification:
   - What new requirements need to be added?
   - What existing requirements need to be updated?
   - Are there new dependencies to include?
   - Are there new constraints or error handling needs?

4. **Design new prompts**
   For each new prompt to be created:
   - What is the role and scope?
   - What are the requirements (5-10 items, testable)?
   - What dependencies need to be included?
   - Follow the prompt structure from the PDD guide

5. **Check for conflicts**
   - Do any changes conflict with existing behavior?
   - Are there breaking changes to interfaces?
   - Will existing tests still pass?

% Output

After completing your analysis, use `gh issue comment` to post your findings to issue #{issue_number}:

```
gh issue comment {issue_number} --repo {repo_owner}/{repo_name} --body "..."
```

Your comment should follow this format:

```markdown
## Step 8: Prompt Change Analysis

**Status:** [Changes Analyzed | No Changes Required]

### Summary
[1-2 sentence summary of the overall change strategy]

### Prompt Modifications

#### `prompts/xxx_{language}.prompt`
**Current state:** [Brief description]
**Changes needed:**
1. Add requirement: [new requirement]
2. Update requirement: [existing â†’ new]
3. Add dependency: `<include>{example_dir}/yyy_example.{ext}</include>`

*(Use actual language and paths from project structure in Step 6)*

#### `prompts/zzz_{language}.prompt`
**New prompt to create:**
- Role: [module purpose]
- Requirements:
  1. [requirement 1]
  2. [requirement 2]
  ...
- Dependencies: [list of includes]

**Extension Analysis (REQUIRED):**
- Modules considered: [list existing modules that were evaluated]
- Why not extendable: [specific reason for each module]
- Capability gap: [what new capability this module provides]

### Interface Changes
- [List any breaking changes or interface updates]
- [How existing code/tests will be affected]

### Risk Assessment
- **Low/Medium/High**: [explanation]
- Mitigation: [how to reduce risk]

---
*Proceeding to Step 9: Implement Changes*
```

**If no changes are needed (STOP workflow):**
```markdown
## Step 8: Prompt Change Analysis

**Status:** No Changes Required

### Analysis
[Explanation of why no prompt changes are needed]

---
*Investigation paused - no prompt changes required.*
```

% Important

- Follow PDD conventions: prompts define WHAT, not HOW
- Requirements should be testable and behavioral
- Keep prompts at 10-30% of expected code size
- Consider backward compatibility
- If no changes are needed, STOP the workflow
- Always post your findings as a GitHub comment before completing
